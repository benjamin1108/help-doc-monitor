# å¤šäº‘å¹³å°å¸®åŠ©æ–‡æ¡£çˆ¬è™«

é€šç”¨çš„äº‘å¹³å°å¸®åŠ©æ–‡æ¡£çˆ¬è™«ï¼Œæ”¯æŒæ‰¹é‡çˆ¬å–å¤šä¸ªäº‘å¹³å°äº§å“çš„å¸®åŠ©æ–‡æ¡£é“¾æ¥ã€‚

## æ”¯æŒçš„äº‘å¹³å°

- âœ… **é˜¿é‡Œäº‘** - é˜¿é‡Œäº‘å¸®åŠ©æ–‡æ¡£
- âœ… **è…¾è®¯äº‘** - è…¾è®¯äº‘äº§å“æ–‡æ¡£
- ğŸš§ **åä¸ºäº‘** - å¼€å‘ä¸­
- ğŸš§ **ç«å±±å¼•æ“** - å¼€å‘ä¸­

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”§ **é€šç”¨æ€§**: é€šè¿‡YAMLé…ç½®æ–‡ä»¶æ”¯æŒå¤šä¸ªé˜¿é‡Œäº‘äº§å“
- ğŸ“ **æœ‰åºè¾“å‡º**: æ¯ä¸ªäº§å“çš„ç»“æœä¿å­˜åœ¨ç‹¬ç«‹ç›®å½•ä¸­
- âš¡ **é«˜æ•ˆçˆ¬å–**: ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹å’Œæ·±åº¦ä¼˜å…ˆç®—æ³•
- ğŸ›¡ï¸ **æ™ºèƒ½è¯†åˆ«**: è‡ªåŠ¨è¯†åˆ«å·²å±•å¼€èœå•ï¼Œé¿å…é‡å¤ç‚¹å‡»
- ğŸ“Š **è¯¦ç»†æŠ¥å‘Š**: ç”Ÿæˆçˆ¬å–æ€»ç»“æŠ¥å‘Š
- ğŸ¯ **çµæ´»é€‰æ‹©**: å¯æŒ‡å®šçˆ¬å–ç‰¹å®šäº§å“æˆ–å…¨éƒ¨äº§å“

## æ–‡ä»¶ç»“æ„

```
.
â”œâ”€â”€ src/
â”‚   â””â”€â”€ help_crawler/
â”‚       â”œâ”€â”€ aliyun/
â”‚       â”‚   â””â”€â”€ aliyun_doc_crawler.py     # é˜¿é‡Œäº‘çˆ¬è™«
â”‚       â”œâ”€â”€ tencentcloud/
â”‚       â”‚   â””â”€â”€ tencentcloud_doc_crawler.py  # è…¾è®¯äº‘çˆ¬è™«
â”‚       â”œâ”€â”€ huaweicloud/                  # åä¸ºäº‘çˆ¬è™«ï¼ˆå¼€å‘ä¸­ï¼‰
â”‚       â””â”€â”€ volcengine/                   # ç«å±±å¼•æ“çˆ¬è™«ï¼ˆå¼€å‘ä¸­ï¼‰
â”œâ”€â”€ config.yaml                          # å¤šäº‘å¹³å°é…ç½®æ–‡ä»¶
â”œâ”€â”€ run_aliyun_crawler.py                # é˜¿é‡Œäº‘çˆ¬è™«è¿è¡Œè„šæœ¬
â”œâ”€â”€ run_tencentcloud_crawler.py          # è…¾è®¯äº‘çˆ¬è™«è¿è¡Œè„šæœ¬
â”œâ”€â”€ requirements.txt                     # ä¾èµ–åº“
â”œâ”€â”€ README.md                           # è¯´æ˜æ–‡æ¡£
â””â”€â”€ out/                                # è¾“å‡ºç›®å½•
    â”œâ”€â”€ aliyun/                         # é˜¿é‡Œäº‘è¾“å‡ºç›®å½•
    â”‚   â”œâ”€â”€ aliyun_vpc_links_20241201_143128.txt
    â”‚   â”œâ”€â”€ aliyun_vpc_data_20241201_143128.json
    â”‚   â””â”€â”€ aliyun_crawl_summary_20241201_143300.txt
    â”œâ”€â”€ tencentcloud/                   # è…¾è®¯äº‘è¾“å‡ºç›®å½•
    â”‚   â”œâ”€â”€ tencentcloud_clb_links_20241201_143052.txt
    â”‚   â”œâ”€â”€ tencentcloud_clb_data_20241201_143052.json
    â”‚   â””â”€â”€ tencentcloud_crawl_summary_20241201_143300.txt
    â””â”€â”€ ...                             # å…¶ä»–å‚å•†ç›®å½•
```

## å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
playwright install chromium
```

## é…ç½®æ–‡ä»¶è¯´æ˜

é…ç½®æ–‡ä»¶ `config.yaml` åŒ…å«é˜¿é‡Œäº‘å’Œè…¾è®¯äº‘ä¸¤ä¸ªå¹³å°çš„é…ç½®ï¼š

### é˜¿é‡Œäº‘é…ç½® (é¡¶çº§é…ç½®)
```yaml
base_url: "https://help.aliyun.com"
crawler_settings:
  headless: true
  wait_timeout: 10000
  click_delay: 0.3
  # ... å…¶ä»–è®¾ç½®
products:
  vpc:
    name: "ä¸“æœ‰ç½‘ç»œ"
    url: "https://help.aliyun.com/zh/vpc/"
    description: "ä¸“æœ‰ç½‘ç»œå¸®åŠ©æ–‡æ¡£"
```

### è…¾è®¯äº‘é…ç½® (tencentcloudèŠ‚ç‚¹ä¸‹)
```yaml
tencentcloud:
  base_url: "https://cloud.tencent.com"
  crawler_settings:
    headless: true
    wait_timeout: 15000  # è…¾è®¯äº‘åŠ è½½è¾ƒæ…¢ï¼Œéœ€è¦æ›´é•¿æ—¶é—´
    click_delay: 0.5     # è…¾è®¯äº‘éœ€è¦æ›´é•¿çš„ç­‰å¾…æ—¶é—´
    # ... å…¶ä»–è®¾ç½®
  products:
    clb:
      name: "è´Ÿè½½å‡è¡¡"
      url: "https://cloud.tencent.com/document/product/214"
      description: "è…¾è®¯äº‘è´Ÿè½½å‡è¡¡CLBå¸®åŠ©æ–‡æ¡£"
```

### é…ç½®å‚æ•°è¯´æ˜
- `headless`: æ˜¯å¦æ— å¤´æ¨¡å¼è¿è¡Œï¼ˆtrue/falseï¼‰
- `wait_timeout`: é¡µé¢åŠ è½½è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
- `click_delay`: ç‚¹å‡»é—´éš”æ—¶é—´ï¼ˆç§’ï¼‰
- `crawl_delay`: æ–‡æ¡£çˆ¬å–é—´éš”ï¼ˆç§’ï¼‰
- `max_depth`: æœ€å¤§å±•å¼€æ·±åº¦
- `debug_mode`: æ˜¯å¦å¯ç”¨è¯¦ç»†è°ƒè¯•è¾“å‡ºï¼ˆtrue/falseï¼‰

### è¾“å‡ºè®¾ç½®
- `base_dir`: è¾“å‡ºç›®å½•å
- `include_content`: æ˜¯å¦åŒ…å«æ–‡æ¡£å†…å®¹ï¼ˆfalseåªä¿å­˜é“¾æ¥ï¼‰

### äº§å“é…ç½®
æ¯ä¸ªäº§å“åŒ…å«ï¼š
- `name`: äº§å“ä¸­æ–‡åç§°
- `url`: å¸®åŠ©æ–‡æ¡£èµ·å§‹é¡µURL
- `description`: äº§å“æè¿°

## è°ƒè¯•è¾“å‡ºè¯´æ˜

å¯ç”¨debug_modeåï¼Œçˆ¬è™«ä¼šæ˜¾ç¤ºè¯¦ç»†çš„èœå•å±•å¼€è¿‡ç¨‹ï¼š

```
ğŸ” å¼€å§‹èœå•å±•å¼€è°ƒè¯•æ¨¡å¼...
============================================================
âœ… æ‰¾åˆ°èœå•å®¹å™¨ï¼Œå¼€å§‹æ·±åº¦ä¼˜å…ˆå±•å¼€...
ğŸ“ [æ·±åº¦ 0] å‘ç° 7 ä¸ªå­å…ƒç´ 
â”œâ”€ [ 1] äº§å“æ¦‚è¿° ğŸ”—
â”‚   â””â”€ ğŸ”½å¯å±•å¼€ ğŸ”—æœ‰é“¾æ¥
â”‚   ğŸ”„ å°è¯•å±•å¼€...
â”‚     ğŸ” å…ƒç´ çŠ¶æ€: class='Menu--level1--xxx', aria-expanded='false'
â”‚     ğŸ¯ ç‚¹å‡»å›¾æ ‡: [class*="arrow"]
â”‚     âœ… ç‚¹å‡»æˆåŠŸ: å›¾æ ‡([class*="arrow"])
â”‚     ğŸ“Š ç‚¹å‡»åaria-expanded: true
â”‚   âœ… å±•å¼€æˆåŠŸï¼Œé€’å½’å¤„ç†å­å…ƒç´ 
  ğŸ“ [æ·±åº¦ 1] å‘ç° 2 ä¸ªå­å…ƒç´ 
  â”œâ”€ [ 1] ä»€ä¹ˆæ˜¯åº”ç”¨å‹è´Ÿè½½å‡è¡¡ALB ğŸ”—
  â”‚   â””â”€ ğŸ“„å¶èŠ‚ç‚¹ ğŸ”—æœ‰é“¾æ¥
  â”‚   ğŸ”— é“¾æ¥: /zh/slb/application-load-balancer/product-overview/what-is-alb
```

ç¬¦å·è¯´æ˜ï¼š
- ğŸ“ æœ‰å­å…ƒç´ çš„èŠ‚ç‚¹  
- ğŸ“„ å¶å­èŠ‚ç‚¹
- ğŸ”½ å¯å±•å¼€  
- ğŸ“‚ å·²å±•å¼€
- ğŸ”— æœ‰é“¾æ¥
- âœ… æ“ä½œæˆåŠŸ
- âŒ æ“ä½œå¤±è´¥

## ä½¿ç”¨æ–¹æ³•

### é˜¿é‡Œäº‘çˆ¬è™«

#### æ–¹æ³•1: ç›´æ¥è¿è¡Œä¸»ç¨‹åº

```bash
python src/help_crawler/aliyun/aliyun_doc_crawler.py
```

#### æ–¹æ³•2: ä½¿ç”¨ç¤ºä¾‹ç¨‹åº

```bash
python example_usage.py
```

#### æ–¹æ³•3: è°ƒè¯•æ¨¡å¼ (æ¨èç”¨äºé—®é¢˜æ’æŸ¥)

```bash
python debug_crawler.py
```

### è…¾è®¯äº‘çˆ¬è™«

#### è¿è¡Œè…¾è®¯äº‘çˆ¬è™«

```bash
python run_tencentcloud_crawler.py
```

#### è…¾è®¯äº‘çˆ¬è™«ç‰¹è‰²åŠŸèƒ½

- **æ·±å±‚çº§èœå•æ”¯æŒ**ï¼šæ”¯æŒ5å±‚ä»¥ä¸Šçš„æ·±åº¦èœå•ç»“æ„
- **ç›®å½•èŠ‚ç‚¹è¾“å‡º**ï¼šé™¤äº†æ–‡æ¡£é“¾æ¥ï¼Œè¿˜è¾“å‡ºç›®å½•èŠ‚ç‚¹ä¿¡æ¯
- **æ™ºèƒ½å±•å¼€ç­‰å¾…**ï¼šæ ¹æ®èœå•æ·±åº¦è‡ªåŠ¨è°ƒæ•´ç­‰å¾…æ—¶é—´
- **ç²¾ç¡®å…ƒç´ è¯†åˆ«**ï¼šé€‚é…è…¾è®¯äº‘ç‰¹æœ‰çš„DOMç»“æ„

#### è¾“å‡ºæ ¼å¼è¯´æ˜

å¤šäº‘å¹³å°çˆ¬è™«çš„è¾“å‡ºæ–‡ä»¶åŒ…å«ä¸¤ç§ç±»å‹çš„é¡¹ç›®ï¼š

1. **å®é™…æ–‡æ¡£é“¾æ¥**ï¼šå¯ç›´æ¥è®¿é—®çš„æ–‡æ¡£é¡µé¢
2. **ç›®å½•èŠ‚ç‚¹**ï¼šæ ‡è®°ä¸º `[ç›®å½•]` çš„èœå•èŠ‚ç‚¹ï¼Œç”¨äºæ„å»ºå®Œæ•´çš„æ–‡æ¡£ç»“æ„

#### è¾“å‡ºç›®å½•ç»“æ„

æ¯ä¸ªäº‘å‚å•†æœ‰ç‹¬ç«‹çš„è¾“å‡ºç›®å½•ï¼š
- é˜¿é‡Œäº‘ï¼š`out/aliyun/`
- è…¾è®¯äº‘ï¼š`out/tencentcloud/`
- åä¸ºäº‘ï¼š`out/huaweicloud/`ï¼ˆå¼€å‘ä¸­ï¼‰
- ç«å±±å¼•æ“ï¼š`out/volcengine/`ï¼ˆå¼€å‘ä¸­ï¼‰

#### åœ¨ä»£ç ä¸­ä½¿ç”¨è…¾è®¯äº‘çˆ¬è™«

```python
import asyncio
import sys
from pathlib import Path
sys.path.insert(0, str(Path(__file__).parent / "src"))

from help_crawler.tencentcloud.tencentcloud_doc_crawler import TencentCloudDocCrawler

async def main():
    crawler = TencentCloudDocCrawler()
    
    # çˆ¬å–æŒ‡å®šäº§å“
    selected_products = ['clb']  # åªçˆ¬å–è´Ÿè½½å‡è¡¡
    results = await crawler.crawl_all_products(selected_products)
    
    # æˆ–çˆ¬å–æ‰€æœ‰äº§å“
    # results = await crawler.crawl_all_products()

if __name__ == "__main__":
    asyncio.run(main())
```

è°ƒè¯•æ¨¡å¼ç‰¹æ€§ï¼š
- ğŸ› è¯¦ç»†çš„èœå•å±•å¼€è¿‡ç¨‹è¾“å‡º
- ğŸŒ³ æ ‘çŠ¶æ˜¾ç¤ºæ–‡æ¡£å±‚çº§ç»“æ„  
- ğŸ¯ å¯é€‰æ‹©ç‰¹å®šäº§å“è¿›è¡Œè°ƒè¯•
- ğŸ‘ï¸ å¯è§†åŒ–æµè§ˆå™¨æ“ä½œè¿‡ç¨‹
- ğŸ“Š å®æ—¶çŠ¶æ€æ£€æŸ¥å’Œé”™è¯¯ä¿¡æ¯

### æ–¹æ³•4: åœ¨ä»£ç ä¸­ä½¿ç”¨

```python
import asyncio
from aliyun_doc_crawler import AliyunDocCrawler

async def main():
    crawler = AliyunDocCrawler()
    
    # çˆ¬å–æŒ‡å®šäº§å“
    selected_products = ['alb', 'nlb', 'ecs']
    results = await crawler.crawl_all_products(selected_products)
    
    # æˆ–çˆ¬å–æ‰€æœ‰äº§å“
    # results = await crawler.crawl_all_products()

if __name__ == "__main__":
    asyncio.run(main())
```

## è¾“å‡ºæ–‡ä»¶

### outç›®å½•åŒ…å«:

#### é˜¿é‡Œäº‘è¾“å‡ºæ–‡ä»¶
- `aliyun_{äº§å“}_links_{æ—¶é—´æˆ³}.txt` - é˜¿é‡Œäº‘äº§å“æ–‡æ¡£é“¾æ¥åˆ—è¡¨
- `aliyun_{äº§å“}_data_{æ—¶é—´æˆ³}.json` - è¯¦ç»†æ–‡æ¡£æ•°æ®ï¼ˆå¦‚æœå¯ç”¨å†…å®¹çˆ¬å–ï¼‰
- `aliyun_crawl_summary_{æ—¶é—´æˆ³}.txt` - é˜¿é‡Œäº‘çˆ¬å–æ€»ç»“æŠ¥å‘Š

#### è…¾è®¯äº‘è¾“å‡ºæ–‡ä»¶
- `tencentcloud_{äº§å“}_links_{æ—¶é—´æˆ³}.txt` - è…¾è®¯äº‘äº§å“æ–‡æ¡£é“¾æ¥åˆ—è¡¨
- `tencentcloud_{äº§å“}_data_{æ—¶é—´æˆ³}.json` - è¯¦ç»†æ–‡æ¡£æ•°æ®ï¼ˆå¦‚æœå¯ç”¨å†…å®¹çˆ¬å–ï¼‰
- `tencentcloud_crawl_summary_{æ—¶é—´æˆ³}.txt` - è…¾è®¯äº‘çˆ¬å–æ€»ç»“æŠ¥å‘Š

## è¾“å‡ºç¤ºä¾‹

```
out/
â”œâ”€â”€ aliyun/
â”‚   â”œâ”€â”€ aliyun_vpc_links_20241201_143128.txt
â”‚   â”œâ”€â”€ aliyun_vpc_data_20241201_143128.json
â”‚   â””â”€â”€ aliyun_crawl_summary_20241201_143300.txt
â”œâ”€â”€ tencentcloud/
â”‚   â”œâ”€â”€ tencentcloud_clb_links_20241201_143052.txt
â”‚   â”œâ”€â”€ tencentcloud_clb_data_20241201_143052.json
â”‚   â””â”€â”€ tencentcloud_crawl_summary_20241201_143300.txt
â””â”€â”€ ...
```

## æ·»åŠ æ–°äº§å“

### æ·»åŠ é˜¿é‡Œäº‘äº§å“

åœ¨ `config.yaml` çš„ `products` éƒ¨åˆ†æ·»åŠ æ–°äº§å“ï¼š

```yaml
products:
  æ–°äº§å“ä»£ç :
    name: "æ–°äº§å“åç§°"
    url: "https://help.aliyun.com/zh/æ–°äº§å“è·¯å¾„"
    description: "æ–°äº§å“æè¿°"
```

### æ·»åŠ è…¾è®¯äº‘äº§å“

åœ¨ `config.yaml` çš„ `tencentcloud.products` éƒ¨åˆ†æ·»åŠ æ–°äº§å“ï¼š

```yaml
tencentcloud:
  products:
    æ–°äº§å“ä»£ç :
      name: "æ–°äº§å“åç§°"
      url: "https://cloud.tencent.com/document/product/äº§å“ID"
      description: "è…¾è®¯äº‘æ–°äº§å“æè¿°"
```

## æ³¨æ„äº‹é¡¹

1. é¦–æ¬¡è¿è¡Œéœ€è¦å®‰è£…Playwrightæµè§ˆå™¨ï¼š`playwright install chromium`
2. å»ºè®®è®¾ç½®é€‚å½“çš„å»¶è¿Ÿæ—¶é—´ï¼Œé¿å…è¯·æ±‚è¿‡äºé¢‘ç¹
3. å¤§é‡äº§å“çˆ¬å–å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œå»ºè®®åˆ†æ‰¹æ‰§è¡Œ
4. ç½‘ç»œå¼‚å¸¸æ—¶çˆ¬è™«ä¼šè‡ªåŠ¨è·³è¿‡å¤±è´¥çš„äº§å“ç»§ç»­æ‰§è¡Œ

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æµè§ˆå™¨å¯åŠ¨å¤±è´¥**
   ```bash
   playwright install chromium
   ```

2. **YAMLé…ç½®é”™è¯¯**
   - æ£€æŸ¥ç¼©è¿›æ˜¯å¦æ­£ç¡®ï¼ˆä½¿ç”¨ç©ºæ ¼ï¼Œä¸è¦ä½¿ç”¨Tabï¼‰
   - ç¡®ä¿å­—ç¬¦ä¸²åŒ…å«åœ¨å¼•å·å†…

3. **ç½‘ç»œè¶…æ—¶**
   - å¢åŠ  `wait_timeout` å€¼
   - æ£€æŸ¥ç½‘ç»œè¿æ¥

4. **æ‰¾ä¸åˆ°èœå•å®¹å™¨**
   - å¯èƒ½æ˜¯é¡µé¢ç»“æ„å‘ç”Ÿå˜åŒ–
   - éœ€è¦æ›´æ–°é€‰æ‹©å™¨

5. **"The object has been collected" é”™è¯¯**
   - è¿™æ˜¯DOMå…ƒç´ å¼•ç”¨å¤±æ•ˆçš„é—®é¢˜
   - çˆ¬è™«å·²å†…ç½®é‡è¯•å’Œåˆ·æ–°æœºåˆ¶
   - å¦‚æœé¢‘ç¹å‡ºç°ï¼Œå¯ä»¥å¢åŠ  `click_delay` å€¼

## è®¸å¯è¯

MIT License 